<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸŒ¸ Avenia Room</title>
<style>
  :root{
    --bg-img: url("bg-space.jpg");

    /* LIGHT */
    --bg1:#ffffff;
    --bg2:#fff4f9;

    --card: rgba(255,255,255,0.86);
    --stroke: rgba(255,182,217,0.55);

    --accent:#ff9fd3;
    --accent2:#bca6ff;
    --accent-deep:#ff67bb;

    --text-main:#2f242b;
    --text-sub:#7b5f6b;

    --shadow: 0 18px 60px rgba(255,137,195,0.24);
    --radius: 26px;

    /* ë°°ê²½ ì˜¤ë²„ë ˆì´ ê°•ë„ (ë¼ì´íŠ¸ëŠ” ë°ê²Œ) */
    --bg-overlay-1: rgba(255,255,255,0.72);
    --bg-overlay-2: rgba(255,244,249,0.65);
    --bg-blur: 0px;
    --bg-dim: 0.22; /* ìš°ì£¼ ì´ë¯¸ì§€ ì–´ë‘ì›€ ì •ë„ */
  }

  html[data-theme="dark"]{
    /* DARK */
    --bg1:#070812;
    --bg2:#0b0c1a;

    --card: rgba(18,16,30,0.76);
    --stroke: rgba(188,166,255,0.25);

    --text-main:#f3e9ef;
    --text-sub:#cdb7c3;

    --shadow: 0 18px 70px rgba(0,0,0,0.45);

    /* ë‹¤í¬ëŠ” ìš°ì£¼ë¥¼ ë” ì„ ëª…í•˜ê²Œ */
    --bg-overlay-1: rgba(5,6,14,0.55);
    --bg-overlay-2: rgba(11,12,26,0.60);
    --bg-blur: 0px;
    --bg-dim: 0.06;
  }

  *{ box-sizing:border-box; }
  html,body{ height:100%; }

  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;

    /* âœ… ì´ëª¨ì§€ í°íŠ¸ ê°•ì œ ì¶”ê°€ (OBS/ìœˆë„ìš°ì—ì„œ ì´ëª¨ì§€ ì•ˆ ëœ¨ëŠ” ë¬¸ì œ ë°©ì§€) */
    font-family:'Poppins','Noto Sans KR','Noto Sans JP',system-ui,sans-serif,
                "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";

    color:var(--text-main);
    padding:28px;
    overflow-x:hidden;

    /* ê¸°ë³¸ ì»¬ëŸ¬ ê·¸ë¼ë°ì´ì…˜ */
    background:
      radial-gradient(900px 500px at 20% 10%, rgba(255,159,211,0.18), transparent 60%),
      radial-gradient(800px 500px at 90% 30%, rgba(188,166,255,0.16), transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  /* ìš°ì£¼ ë°°ê²½ ë ˆì´ì–´ */
  body::before{
    content:"";
    position:fixed;
    inset:0;
    background-image: var(--bg-img);
    background-size: cover;
    background-position:center;
    background-repeat:no-repeat;
    filter: blur(var(--bg-blur));
    opacity: 1;
    z-index:-2;
  }

  /* ê°€ë…ì„± ì˜¤ë²„ë ˆì´ */
  body::after{
    content:"";
    position:fixed;
    inset:0;
    background:
      radial-gradient(900px 600px at 30% 20%, rgba(255,159,211,0.20), transparent 55%),
      radial-gradient(900px 700px at 80% 35%, rgba(188,166,255,0.22), transparent 55%),
      linear-gradient(180deg, var(--bg-overlay-1), var(--bg-overlay-2));
    z-index:-1;
  }

  /* ìš°ì£¼ ì´ë¯¸ì§€ ìì²´ì˜ ë””ë°(ì–´ë‘ì›€) */
  .bg-dim{
    position:fixed;
    inset:0;
    background: rgba(0,0,0,var(--bg-dim));
    z-index:-1;
    pointer-events:none;
  }

  .wrap{ width:min(1040px,96vw); }

  .card{
    position:relative;
    background:var(--card);
    border:1.5px solid var(--stroke);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    backdrop-filter: blur(14px);
    padding:34px;
    overflow:hidden;
    animation: fadeIn .55s ease;
  }

  /* ìƒë‹¨ í—¤ë” */
  .header{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:14px;
    margin-bottom:14px;
  }

  h1{
    margin:0;
    font-size: clamp(28px, 3vw, 42px);
    letter-spacing:-0.6px;
    background: linear-gradient(90deg, var(--accent-deep), var(--accent2), var(--accent));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
  }

  .subtitle{
    margin:8px 0 0;
    color:var(--text-sub);
    font-weight:700;
    font-size:14px;
  }

  /* í—¤ë” ë²„íŠ¼ë“¤ */
  .top-actions{
    display:flex;
    gap:10px;
    align-items:center;
  }

  .pill-btn{
    border:1.5px solid var(--stroke);
    background: rgba(255,255,255,0.55);
    color:var(--text-main);
    border-radius:999px;
    padding:10px 12px;
    font-weight:900;
    cursor:pointer;
    transition: .22s ease;
    user-select:none;
  }
  html[data-theme="dark"] .pill-btn{
    background: rgba(20,18,32,0.55);
  }
  .pill-btn:hover{ transform: translateY(-1px); }
  .pill-btn:active{ transform: translateY(0px) scale(0.98); }

  /* íƒ­ (ì˜ˆì˜ê²Œ) */
  .tabs{
    display:flex;
    justify-content:center;
    gap:10px;
    margin:16px 0 12px;
    flex-wrap:wrap;
  }
  .tab{
    position:relative;
    padding:10px 14px;
    border-radius:999px;
    border:1.5px solid var(--stroke);
    background: rgba(255,255,255,0.52);
    color:var(--text-main);
    font-weight:950;
    cursor:pointer;
    transition: transform .18s ease, background .22s ease, border-color .22s ease;
    overflow:hidden;
  }
  html[data-theme="dark"] .tab{
    background: rgba(20,18,32,0.52);
  }

  /* ë°˜ì§ í•˜ì´ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
  .tab::before{
    content:"";
    position:absolute;
    inset:-2px;
    background: radial-gradient(140px 60px at 20% 0%, rgba(255,103,187,0.35), transparent 60%),
                radial-gradient(140px 60px at 80% 100%, rgba(188,166,255,0.32), transparent 60%);
    opacity:0;
    transition: opacity .22s ease;
  }
  .tab:hover{ transform: translateY(-1px); }
  .tab:hover::before{ opacity:1; }

  /* í™œì„± íƒ­: ì•„ë˜ ê¸€ë¡œìš° + ì‚´ì§ íŠ€ëŠ” ëŠë‚Œ */
  .tab.active{
    border-color: rgba(255,103,187,0.35);
    background: linear-gradient(90deg, rgba(255,103,187,0.20), rgba(188,166,255,0.18), rgba(255,159,211,0.18));
    transform: translateY(-1px);
  }
  .tab.active::after{
    content:"";
    position:absolute;
    left:10px; right:10px; bottom:-10px;
    height:14px;
    background: radial-gradient(closest-side, rgba(255,103,187,0.45), transparent 70%);
    filter: blur(6px);
    opacity:0.75;
  }

  /* íƒ­ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
  .section{
    display:none;
    margin-top: 8px;
    animation: slideUp .35s ease;
  }
  .section.active{ display:block; }

  @keyframes slideUp{
    from { opacity:0; transform: translateY(8px); }
    to   { opacity:1; transform: translateY(0); }
  }

  /* ì–¸ì–´ ìŠ¤ìœ„ì¹˜ */
  .lang-switch{
    display:flex;
    justify-content:center;
    gap:10px;
    margin: 6px 0 18px;
    flex-wrap:wrap;
  }
  .chip{
    padding:9px 12px;
    border-radius:999px;
    border:1.5px solid var(--stroke);
    background: rgba(255,255,255,0.52);
    color:var(--text-main);
    font-weight:950;
    cursor:pointer;
    transition: .22s ease;
  }
  html[data-theme="dark"] .chip{
    background: rgba(20,18,32,0.52);
  }
  .chip.active, .chip:hover{
    background: rgba(255,159,211,0.18);
    border-color: rgba(255,103,187,0.28);
    transform: translateY(-1px);
  }

  #greeting{
    font-size:15px;
    margin:0 0 6px;
    color:var(--text-sub);
    font-weight:750;
    opacity:0;
    animation: fadeInText 1.0s ease forwards;
  }

  /* ë¦¬ìŠ¤íŠ¸ */
  ul{ list-style:none; padding:0; margin:0; }
  li{
    background: rgba(255,244,250,0.72);
    margin:10px 0;
    padding:13px 16px;
    border-radius:16px;
    border:1px solid rgba(255,182,217,0.30);
    box-shadow: 0 6px 18px rgba(255,182,193,0.14);
    transition: .18s ease;
  }
  html[data-theme="dark"] li{
    background: rgba(24,20,40,0.52);
    border-color: rgba(188,166,255,0.18);
    box-shadow: 0 10px 26px rgba(0,0,0,0.28);
  }
  li:hover{ transform: translateY(-1px); }

  /* ì¼ì • ì„¹ì…˜ ë°•ìŠ¤ */
  .panel{
    margin-top: 12px;
    background: rgba(255,244,250,0.60);
    border:1px solid rgba(255,182,217,0.28);
    border-radius:20px;
    padding:18px;
  }
  html[data-theme="dark"] .panel{
    background: rgba(24,20,40,0.46);
    border-color: rgba(188,166,255,0.18);
  }
  .panel h2{
    font-size:18px;
    margin:0 0 8px;
    color:var(--accent-deep);
    letter-spacing:-0.3px;
  }
  .panel p{
    margin:6px 0;
    color:var(--text-sub);
    font-weight:750;
  }

  /* ë¼ì´ë¸Œ ë²„íŠ¼ */
  .live-buttons{
    margin-top:18px;
    display:flex;
    gap:10px;
    justify-content:center;
    flex-wrap:wrap;
  }
  .live-buttons a{
    text-decoration:none;
    padding:11px 18px;
    border-radius:999px;
    font-weight:950;
    color:white;
    transition:.22s ease;
    box-shadow: 0 10px 24px rgba(0,0,0,0.12);
  }
  .twitch{ background: linear-gradient(90deg, #9146ff, #bca6ff); }
  .chzzk { background: linear-gradient(90deg, #34d399, #4ad37d); }
  .live-buttons a:hover{ transform: translateY(-1px); opacity:0.93; }

  /* ì†Œì…œ */
  .social{
    margin-top:14px;
    display:flex;
    gap:12px;
    justify-content:center;
    flex-wrap:wrap;
  }
  .social a{
    width:44px; height:44px;
    border-radius:999px;
    background: rgba(255,255,255,0.60);
    display:grid;
    place-items:center;
    box-shadow: 0 8px 18px rgba(255,182,193,0.16);
    border: 1px solid rgba(255,182,217,0.28);
    transition:.22s ease;
    text-decoration:none;

    /* âœ… ì´ëª¨ì§€ í¬ê¸°/ì •ë ¬ ì•ˆì •í™” */
    font-size: 20px;
    line-height: 1;
  }
  html[data-theme="dark"] .social a{
    background: rgba(20,18,32,0.56);
    border-color: rgba(188,166,255,0.18);
    box-shadow: 0 10px 26px rgba(0,0,0,0.28);
  }
  .social a:hover{ transform: translateY(-1px); background: rgba(255,159,211,0.16); }

  /* âœ… X ì „ìš©(ì¶”ê°€) */
  .social a.x{
    font-weight: 1000;
    letter-spacing: -0.5px;
  }

  footer{
    margin-top:18px;
    font-size:12px;
    color: rgba(123,95,107,0.90);
    text-align:center;
    font-weight:700;
  }
  html[data-theme="dark"] footer{ color: rgba(205,183,195,0.85); }

  /* RP */
  .rp-grid{
    display:grid;
    grid-template-columns:1fr;
    gap:14px;
    margin-top:8px;
  }
  @media (min-width: 820px){
    .rp-grid{ grid-template-columns: 1.05fr 0.95fr; align-items:start; }
  }
  .rp-card{
    background: rgba(255,255,255,0.58);
    border:1px solid rgba(255,182,217,0.28);
    border-radius:20px;
    padding:16px;
    box-shadow: 0 10px 26px rgba(255,182,193,0.14);
  }
  html[data-theme="dark"] .rp-card{
    background: rgba(20,18,32,0.56);
    border-color: rgba(188,166,255,0.18);
    box-shadow: 0 10px 30px rgba(0,0,0,0.30);
  }

  .rp-title{
    display:flex;
    align-items:center;
    gap:10px;
    margin:0 0 10px;
    font-weight:1000;
    letter-spacing:-0.2px;
  }
  .badge{
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(255,182,217,0.32);
    background: rgba(255,159,211,0.14);
    font-size:12px;
    font-weight:950;
    color:var(--text-main);
  }
  html[data-theme="dark"] .badge{
    border-color: rgba(188,166,255,0.22);
    background: rgba(188,166,255,0.10);
  }

  .rp-text{
    margin:0;
    line-height:1.65;
    color:var(--text-main);
    font-weight:700;
    white-space:pre-line;
  }

  .rp-hr{
    margin:12px 0;
    border:none;
    height:1px;
    background: linear-gradient(90deg, transparent, rgba(255,103,187,0.35), rgba(188,166,255,0.28), transparent);
  }

  .avatars{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }
  .avatar{
    background: rgba(255,244,250,0.56);
    border:1px solid rgba(255,182,217,0.24);
    border-radius:18px;
    padding:10px;
    box-shadow: 0 8px 20px rgba(255,182,193,0.12);
  }
  html[data-theme="dark"] .avatar{
    background: rgba(24,20,40,0.46);
    border-color: rgba(188,166,255,0.16);
    box-shadow: 0 10px 26px rgba(0,0,0,0.28);
  }
  .avatar .label{
    font-weight:950;
    color:var(--text-sub);
    font-size:12px;
    margin:0 0 8px;
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  .avatar img{
    width:100%;
    height:220px;
    object-fit:contain;
    border-radius:14px;
    background: rgba(255,255,255,0.62);
  }
  html[data-theme="dark"] .avatar img{
    background: rgba(10,10,18,0.45);
  }
  @media (max-width: 520px){
    .avatars{ grid-template-columns:1fr; }
    .avatar img{ height:240px; }
  }

  @keyframes fadeIn{
    from{ opacity:0; transform: translateY(8px); }
    to{ opacity:1; transform: translateY(0); }
  }
  @keyframes fadeInText{ to{ opacity:1; } }

  /* BGM Track Select */
  .pill-select{
    border:1.5px solid var(--stroke);
    background: rgba(255,255,255,0.55);
    color:var(--text-main);
    border-radius:999px;
    padding:10px 12px;
    font-weight:900;
    cursor:pointer;
    transition: .22s ease;
    user-select:none;
    appearance:none;
    -webkit-appearance:none;
    outline:none;
  }
  html[data-theme="dark"] .pill-select{ background: rgba(20,18,32,0.55); }
  .pill-select:hover{ transform: translateY(-1px); }

  /* Fortune */
  .fortune-box{
    margin-top: 12px;
    background: rgba(255,244,250,0.60);
    border:1px solid rgba(255,182,217,0.28);
    border-radius:20px;
    padding:18px;
  }
  html[data-theme="dark"] .fortune-box{
    background: rgba(24,20,40,0.46);
    border-color: rgba(188,166,255,0.18);
  }

  .fortune-top{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
  }
  .fortune-meta{
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .fortune-date{
    font-weight:1000;
    letter-spacing:-0.2px;
    color: var(--text-main);
  }
  .fortune-hint{
    font-weight:800;
    color: var(--text-sub);
    font-size: 13px;
  }

  .fortune-btn{
    border:1.5px solid var(--stroke);
    background: linear-gradient(90deg, rgba(255,103,187,0.22), rgba(188,166,255,0.18), rgba(255,159,211,0.18));
    color:var(--text-main);
    border-radius:999px;
    padding:10px 14px;
    font-weight:1000;
    cursor:pointer;
    transition: .18s ease;
    user-select:none;
  }
  .fortune-btn:hover{ transform: translateY(-1px); }
  .fortune-btn:active{ transform: translateY(0px) scale(0.98); }

  .fortune-result{
    margin-top:12px;
    padding:14px 16px;
    border-radius:16px;
    border:1px solid rgba(255,182,217,0.28);
    background: rgba(255,255,255,0.58);
    box-shadow: 0 10px 26px rgba(255,182,193,0.12);
    min-height: 52px;
    font-weight:800;
    line-height:1.55;
    white-space:pre-line;
  }
  html[data-theme="dark"] .fortune-result{
    background: rgba(20,18,32,0.56);
    border-color: rgba(188,166,255,0.18);
    box-shadow: 0 10px 30px rgba(0,0,0,0.28);
  }

  .luck-wrap{ margin-top: 12px; }
  .luck-label{
    font-size: 13px;
    font-weight: 950;
    color: var(--text-sub);
    margin-bottom: 8px;
  }
  .luck-bar{
    height: 12px;
    border-radius: 999px;
    background: rgba(0,0,0,0.08);
    overflow:hidden;
    border:1px solid rgba(255,182,217,0.22);
  }
  html[data-theme="dark"] .luck-bar{
    background: rgba(255,255,255,0.10);
    border-color: rgba(188,166,255,0.14);
  }
  .luck-fill{
    height: 100%;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(255,103,187,0.55), rgba(188,166,255,0.55), rgba(255,159,211,0.55));
    width: 0%;
    transition: width .55s ease;
  }

  /* =========================
     âœ… ì¶”ê°€: ë¡œê³  + ìƒë‹¨ í° ë²„íŠ¼(YouTube/Twitch/Chzzk/SOOP)
     ========================= */

  .brand{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .brand-logo{
    width:56px;
    height:56px;
    object-fit:contain;
    border-radius:16px;
    background: rgba(255,255,255,0.55);
    border:1px solid rgba(255,182,217,0.28);
    box-shadow: 0 10px 24px rgba(255,137,195,0.16);
  }
  html[data-theme="dark"] .brand-logo{
    background: rgba(20,18,32,0.55);
    border-color: rgba(188,166,255,0.18);
    box-shadow: 0 10px 26px rgba(0,0,0,0.28);
  }

  .hero-buttons{
    margin: 10px 0 16px;
    display:flex;
    gap:12px;
    justify-content:center;
    flex-wrap:wrap;
  }
  .hero-buttons a{
    text-decoration:none;
    padding: 14px 22px;
    border-radius: 999px;
    font-weight: 1000;
    font-size: 16px;
    color: white;
    transition: .22s ease;
    box-shadow: 0 14px 30px rgba(0,0,0,0.14);
    letter-spacing: -0.2px;
  }
  .hero-buttons a:hover{ transform: translateY(-1px); opacity:0.94; }

  /* âœ… ìƒë‹¨ í° ë²„íŠ¼ ì „ìš© ìƒ‰ */
  .hero-buttons .youtube{ background: linear-gradient(90deg, #ff3b3b, #ff7a7a); }
  .hero-buttons .twitch{ background: linear-gradient(90deg, #9146ff, #bca6ff); }
  .hero-buttons .chzzk { background: linear-gradient(90deg, #34d399, #4ad37d); }
  .hero-buttons .soop  { background: linear-gradient(90deg, #22c55e, #a3e635); }

</style>
</head>

<body>
  <div class="bg-dim"></div>

  <!-- Sound -->
  <audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_eead05cf8d.mp3?filename=click-124467.mp3"></audio>
  <audio id="bgm" loop></audio>

  <div class="wrap">
    <div class="card">

      <div class="header">
        <div class="brand">
          <img class="brand-logo" src="ë¡œê³ .png" alt="Avenia Logo">
          <div>
            <h1>ğŸŒ¸ Avenia Room</h1>
            <div class="subtitle" id="subline">Selenoid Gel â€¢ Cosmic Rift â€¢ Nekomata Soul</div>
          </div>
        </div>

        <div class="top-actions">
          <button id="theme-toggle" class="pill-btn" title="Theme">ğŸŒ™ Night</button>
          <select id="track-select" class="pill-select" title="Track"></select>
          <button id="bgm-toggle" class="pill-btn" title="BGM">ğŸµ BGM On</button>
        </div>
      </div>

      <!-- âœ… ìƒë‹¨ í° ë²„íŠ¼: YouTube / Twitch / Chzzk / SOOP -->
      <div class="hero-buttons">
        <a href="https://www.youtube.com/@Avenia-k6l2x" class="youtube" target="_blank" rel="noopener">â–¶ï¸ YouTube</a>
        <a href="https://www.twitch.tv/aven1231" class="twitch" target="_blank" rel="noopener">ğŸŸ£ Twitch</a>
        <a href="https://chzzk.naver.com/911df19d52a45f1d08791b2d43517dee" class="chzzk" target="_blank" rel="noopener">ğŸŸ¢ Chzzk</a>
        <a href="https://www.sooplive.co.kr/station/slimeavenia" class="soop" target="_blank" rel="noopener">ğŸŒ¿ SOOP</a>
      </div>

      <p id="greeting"></p>

      <!-- Tabs -->
      <div class="tabs">
        <button class="tab active" data-tab="home">ğŸ  í™ˆ</button>
        <button class="tab" data-tab="rules">ğŸ“œ ê·œì¹™</button>
        <button class="tab" data-tab="schedule">ğŸ™ ë°©ì†¡ ì¼ì •</button>
        <button class="tab" data-tab="fortune">ğŸ”® ìš´ì„¸</button>
        <button class="tab" data-tab="rp">â˜ªï¸ RP ì†Œê°œ</button>
      </div>

      <!-- Language Buttons -->
      <div class="lang-switch">
        <button class="chip active" data-lang="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</button>
        <button class="chip" data-lang="en">ğŸ‡ºğŸ‡¸ English</button>
        <button class="chip" data-lang="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</button>
      </div>

      <!-- HOME -->
      <section id="section-home" class="section active">
        <div class="panel">
          <h2 id="home-title"></h2>
          <p id="home-desc"></p>
        </div>

        <!-- âŒ ì¤‘ë³µ ì œê±°: ì•„ë˜ live-buttons ë¸”ë¡ ì‚­ì œë¨ -->

        <div class="social">
          <a href="https://discord.gg/HMEFa3CPc8" target="_blank" rel="noopener" title="Discord">ğŸ’¬</a>
          <a href="https://www.youtube.com/@Avenia-k6l2x" target="_blank" rel="noopener" title="YouTube">â–¶ï¸</a>
          <a href="https://x.com/aven1166793?s=21" target="_blank" rel="noopener" title="X" class="x">ğ•</a>
          <a href="https://toon.at/donate/aven" target="_blank" rel="noopener" title="Donate">ğŸ’</a>
          <a href="https://fancim.me/celeb/profile.aspx?url=758954" target="_blank" rel="noopener" title="íŒ¬ì‹¬">ğŸ</a>
          <a href="https://comic.naver.com/community/u/Even77777?lastPage=Creators" target="_blank" rel="noopener" title="Naver Comic">ğŸ–‹ï¸</a>
          <a href="https://cafe.naver.com/f-e/cafes/31529869/menus/0?t=1762537197544" target="_blank" rel="noopener" title="Cafe">â˜•</a>
        </div>

        <footer>Â© 2025 Avenia. All Rights Reserved.</footer>
      </section>

      <!-- RULES -->
      <section id="section-rules" class="section">
        <div class="panel">
          <h2 id="rules-title"></h2>
          <p id="rules-desc"></p>
        </div>
        <ul id="rules"></ul>
        <footer id="rules-footer"></footer>
      </section>

      <!-- SCHEDULE -->
      <section id="section-schedule" class="section">
        <div class="panel">
          <h2 id="schedule-title"></h2>
          <p id="schedule-time"></p>
          <p id="schedule-note1"></p>
        </div>
        <ul id="schedule-list"></ul>
        <footer id="schedule-footer"></footer>
      </section>

      <!-- FORTUNE -->
      <section id="section-fortune" class="section">
        <div class="panel">
          <h2 id="fortune-title"></h2>
          <p id="fortune-desc"></p>
        </div>

        <div class="fortune-box">
          <div class="fortune-top">
            <div class="fortune-meta">
              <div class="fortune-date" id="fortune-date"></div>
              <div class="fortune-hint" id="fortune-hint"></div>
            </div>

            <button id="fortune-roll" class="fortune-btn" type="button">ğŸ”® ìš´ì„¸ ë½‘ê¸°</button>
          </div>

          <div id="fortune-result" class="fortune-result" aria-live="polite"></div>

          <div class="luck-wrap">
            <div class="luck-label" id="luck-label"></div>
            <div class="luck-bar">
              <div class="luck-fill" id="luck-fill" style="width:0%"></div>
            </div>
          </div>
        </div>

        <footer id="fortune-footer"></footer>
      </section>

      <!-- RP -->
      <section id="section-rp" class="section">
        <div class="rp-grid">
          <div class="rp-card">
            <div class="rp-title">
              <span class="badge" id="rp-badge">RP</span>
              <span id="rp-title">Avenia</span>
            </div>
            <p class="rp-text" id="rp-text"></p>
            <hr class="rp-hr">
            <p class="rp-text" id="rp-stream-setting"></p>
          </div>

          <div class="rp-card">
            <div class="rp-title">
              <span class="badge">Avatar</span>
              <span id="rp-visual-title">Forms</span>
            </div>

            <div class="avatars">
              <div class="avatar">
                <div class="label"><span id="label-slime">ìŠ¬ë¼ì„ í¼</span><span>ğŸŸ£</span></div>
                <img src="slime.png" alt="Slime Form">
              </div>
              <div class="avatar">
                <div class="label"><span id="label-human">ì¸ê°„ í¼</span><span>ğŸŒ¸</span></div>
                <img src="human.png" alt="Human Form">
              </div>
            </div>

            <footer style="margin-top:14px;">â˜ªï¸ Avenia Lore Panel</footer>
          </div>
        </div>
      </section>

    </div>
  </div>

<script>
/* Greeting */
const greetings = {
  ko: ["ì˜¤ëŠ˜ë„ ì°¾ì•„ì™€ì¤˜ì„œ ê³ ë§ˆì›Œìš” ğŸŒ¸", "Avenia ë£¸ì— ì˜¤ì‹  ê±¸ í™˜ì˜í•´ìš” ğŸ’•"],
  en: ["Welcome to Aveniaâ€™s Stream Room ğŸ’•", "Glad to see you again ğŸŒ¸"],
  ja: ["ã‚ˆã†ã“ãã€Aveniaã®é…ä¿¡ãƒ«ãƒ¼ãƒ ã¸ ğŸŒ¸", "ä»Šæ—¥ã‚‚æ¥ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã† ğŸ’•"]
};

/* HOME text */
const homeData = {
  ko: { title: "ğŸŒŒ Avenia Room", desc: "ìš°ì£¼ì˜ ê· ì—´ì—ì„œ íƒœì–´ë‚œ ì…€ë ˆë…¸ì´ë“œ ì ¤, Aveniaì˜ ê³µê°„ì…ë‹ˆë‹¤." },
  en: { title: "ğŸŒŒ Avenia Room", desc: "Aveniaâ€™s space, a Selenoid Gel born from a cosmic rift." },
  ja: { title: "ğŸŒŒ Avenia Room", desc: "å®‡å®™ã®äº€è£‚ã‹ã‚‰ç”Ÿã¾ã‚ŒãŸã‚»ë ˆë…¸ã‚¤ãƒ‰ãƒ»ã‚¸ã‚§ãƒ«ã€Aveniaã®ç©ºé–“ã§ã™ã€‚" }
};

/* RULES */
const rulesData = {
  ko: {
    title: "ğŸ“œ ì±„íŒ… ê·œì¹™",
    desc: "ì´ ê³µê°„ì€ ëª¨ë‘ê°€ í¸í•˜ê²Œ ë¨¸ë¬´ë¥¼ ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤.",
    footer: "â€» ì–´ë ¤ìš´ ê·œì¹™ ì•„ë‹ˆë‹ˆê¹~ ì§€ì¼œì£¼ì„¸ìš”~.",
    list: [
      'ì˜ˆì˜ì™€ ì¡´ì¤‘ì„ ì§€ì¼œì£¼ì„¸ìš”.',
      'ë¬´ë¡€, ë¹„í•˜, ìš•ì„¤ì€ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
      'ì •ì¹˜ / ì¢…êµ / ë¯¼ê°í•œ ì£¼ì œëŠ” ê¸ˆì§€ì…ë‹ˆë‹¤.',
      'ìŠ¤í¬ì¼ëŸ¬ ë° TMI ìì œ ë°”ëë‹ˆë‹¤.',
      'íƒ€ì¸ì˜ í‰íŒì„ í•´ì¹˜ëŠ” ì±„íŒ…ì€ ê¸ˆì§€ì…ë‹ˆë‹¤.'
    ]
  },
  en: {
    title: "ğŸ“œ Chat Rules",
    desc: "This is a space where everyone can feel comfortable.",
    footer: "â€» It's not a difficult rule, so please keep it ",
    list: [
      'Please be polite and respectful.',
      'Rudeness, insults, or profanity are not tolerated.',
      'Politics, religion, and sensitive topics are prohibited.',
      'Avoid spoilers or excessive personal sharing.',
      'Do not post messages that harm othersâ€™ reputation.'
    ]
  },
  ja: {
    title: "ğŸ“œ ãƒ«ãƒ¼ãƒ«",
    desc: "ã“ã“ã¯ã€èª°ã‚‚ãŒå®‰å¿ƒã—ã¦éã”ã›ã‚‹å ´æ‰€ã§ã™ã€‚",
    footer: "â€» é›£ã—ã„ãƒ«ãƒ¼ãƒ«ã§ã¯ãªã„ã®ã§ã€å®ˆã£ã¦ãã ã•ã„ ",
    list: [
      'ç¤¼å„€ã¨æ•¬æ„ã‚’å¤§åˆ‡ã«ã—ã¦ãã ã•ã„ã€‚',
      'ç„¡ç¤¼ã€ä¾®è¾±ã€æš´è¨€ã¯ç¦æ­¢ã§ã™ã€‚',
      'æ”¿æ²»ã€å®—æ•™ã€ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãªè©±é¡Œã¯ç¦æ­¢ã§ã™ã€‚',
      'ãƒã‚¿ãƒãƒ¬ã‚„TMIã¯æ§ãˆã¦ãã ã•ã„ã€‚',
      'ä»–äººã®è©•åˆ¤ã‚’å‚·ã¤ã‘ã‚‹ç™ºè¨€ã¯ç¦æ­¢ã§ã™ã€‚'
    ]
  }
};

/* SCHEDULE (ìš”ì²­ ë°˜ì˜: ê¸°ë³¸ 16~19, ì¬í•™ì¤‘ 20ì‹œ ì´í›„) */
const scheduleData = {
  ko: {
    title: "ğŸ™ ë°©ì†¡ ì¼ì •",
    time: "ê¸°ë³¸: 16:00 ~ 19:00 - ëª© / ê¸ˆ / í†  / ì¼ ì£¼ ë°©ì†¡",
    note1: "ì¬í•™ ì¤‘: 20:00 ì´í›„ ë°©ì†¡ (ìƒí™©ì— ë”°ë¼ ë³€ë™ ê°€ëŠ¥)",
    footer: "",
    days: [
      "ê³µì§€: ì¼ì •ì€ ìƒí™©ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
    ]
  },
  en: {
    title: "ğŸ™ Stream Schedule",
    time: "Default: 4:00 PM ~ 7:00 PM (KST)",
    note1: "During school term: streams start after 8:00 PM (may vary)",
    footer: "",
    days: [
      "Note: Schedule may change depending on circumstances."
    ]
  },
  ja: {
    title: "ğŸ™ é…ä¿¡ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«",
    time: "åŸºæœ¬ï¼š16:00ï½19:00ï¼ˆéŸ“å›½æ™‚é–“ï¼‰",
    note1: "åœ¨å­¦ä¸­ï¼š20:00ä»¥é™ã«é…ä¿¡ï¼ˆçŠ¶æ³ã«ã‚ˆã‚Šå¤‰å‹•ï¼‰",
    footer: "",
    days: [
      "â€» äºˆå®šã¯çŠ¶æ³ã«ã‚ˆã‚Šå¤‰æ›´ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚"
    ]
  }
};

/* RP */
const rpData = {
  ko: {
    title: "ì—ì´ë¸ (Avenia)",
    badge: "RP / ì†Œê°œ",
    slimeLabel: "ìŠ¬ë¼ì„ í¼",
    humanLabel: "ì¸ê°„ í¼",
    text:
`ì´ë¦„ : ì—ì´ë¸ (Avenia)
ì¢…ì¡± : ì…€ë ˆë…¸ì´ë“œ ì ¤ (Selenoid Gel)
íƒ„ìƒ : ë¶•ê´´ëœ ìš°ì£¼ì˜ ê· ì—´ì—ì„œ íƒœì–´ë‚¨
ì™¸í˜• : ìŠ¬ë¼ì„ (ì ¤ë¦¬)

ì„¤ëª… : ê³ ì–‘ì´ê°€ ë„¤ì½”ë§ˆíƒ€ë¡œ ë³€ì´í•œ ì´í›„, ê·¸ ì˜í˜¼ì´ ìš°ì£¼ì˜ ê· ì—´ì²´ì™€ ìœµí•©ëœ ì¡´ì¬.
ìœ¡ì²´ëŠ” ì†Œë©¸í–ˆìœ¼ë‚˜, ì˜ì‹ì€ ê· ì—´ ì†ì—ì„œ ìƒˆë¡œìš´ í˜•íƒœë¡œ ì¬êµ¬ì„±ë˜ì—ˆë‹¤.`,
    streamSetting:
`ë°©ì†¡ ì¤‘ ì„¤ì •:
ë°©ì†¡ ì¤‘ì—ëŠ” ì¸ê°„ í˜•íƒœë¡œ í™œë™í•˜ì§€ë§Œ,
ì„¸ê³„ê´€ìƒ ë³¸ì§ˆì€ í•­ìƒ ìŠ¬ë¼ì„ ìƒíƒœë¡œ ìœ ì§€ëœë‹¤.`
  },
  en: {
    title: "Avenia",
    badge: "RP / Lore",
    slimeLabel: "Slime Form",
    humanLabel: "Human Form",
    text:
`Name: Aven (Avenia)
Species: Selenoid Gel
Birth: Born from a collapsing cosmic rift
Form: Slime (jelly)

Description: After a cat mutated into a Nekomata, its soul fused with a cosmic rift-entity.
The body was lost, but the consciousness was reconstituted into a new form within the rift.`,
    streamSetting:
`Stream Setting:
During streams, Avenia acts in a human form,
but the true essence remains in a slime state within the lore.`
  },
  ja: {
    title: "ã‚¨ã‚¤ãƒ´ãƒ³ï¼ˆAveniaï¼‰",
    badge: "RP / ç´¹ä»‹",
    slimeLabel: "ã‚¹ãƒ©ã‚¤ãƒ å½¢æ…‹",
    humanLabel: "äººé–“å½¢æ…‹",
    text:
`åå‰ï¼šã‚¨ã‚¤ãƒ´ãƒ³ï¼ˆAveniaï¼‰
ç¨®æ—ï¼šã‚»ãƒ¬ãƒã‚¤ãƒ‰ãƒ»ã‚¸ã‚§ãƒ«ï¼ˆSelenoid Gelï¼‰
èª•ç”Ÿï¼šå´©å£Šã—ãŸå®‡å®™ã®äº€è£‚ã‹ã‚‰èª•ç”Ÿ
å¤–è¦‹ï¼šã‚¹ãƒ©ã‚¤ãƒ ï¼ˆã‚¼ãƒªãƒ¼çŠ¶ï¼‰

èª¬æ˜ï¼šçŒ«ãŒãƒã‚³ãƒã‚¿ã¸ã¨å¤‰ç•°ã—ãŸå¾Œã€ãã®é­‚ãŒå®‡å®™ã®äº€è£‚ä½“ã¨èåˆã—ãŸå­˜åœ¨ã€‚
è‚‰ä½“ã¯å¤±ã‚ã‚ŒãŸãŒã€æ„è­˜ã¯äº€è£‚ã®ä¸­ã§æ–°ãŸãªå½¢ã¨ã—ã¦å†æ§‹ç¯‰ã•ã‚ŒãŸã€‚`,
    streamSetting:
`é…ä¿¡ä¸­ã®è¨­å®šï¼š
é…ä¿¡ä¸­ã¯äººé–“å½¢æ…‹ã§æ´»å‹•ã™ã‚‹ãŒã€
ä¸–ç•Œè¦³ä¸Šã®æœ¬è³ªã¯å¸¸ã«ã‚¹ãƒ©ã‚¤ãƒ ã®ã¾ã¾ã§ã‚ã‚‹ã€‚`
  }
};

/* Fortune */
const fortuneData = {
  ko: {
    title: "ğŸ”® ì˜¤ëŠ˜ì˜ ìš´ì„¸",
    desc: "ì¬ë¯¸ë¡œë§Œ ë³´ëŠ” ê· ì—´ ìš´ì„¸. ë§ˆìŒì— ì•ˆ ë“¤ë©´ ë‹¤ì‹œ ë½‘ì•„ë„ ë¨.",
    hint: "ë²„íŠ¼ ëˆŒëŸ¬ì„œ í•œ ë²ˆ ë½‘ì•„.",
    footer: "â€» ì§„ì§€í•˜ê²Œ ë¯¿ì§€ ë§ ê²ƒ. ì¬ë¯¸ëŠ” OK.",
    luckLabel: "ì˜¤ëŠ˜ì˜ ìš´(%)",
    roll: "ğŸ”® ìš´ì„¸ ë½‘ê¸°"
  },
  en: {
    title: "ğŸ”® Daily Fortune",
    desc: "Just for fun. Rift fortune of the day. Donâ€™t like it? Roll again.",
    hint: "Tap the button and draw one.",
    footer: "â€» For fun only.",
    luckLabel: "Luck (%)",
    roll: "ğŸ”® Draw Fortune"
  },
  ja: {
    title: "ğŸ”® ä»Šæ—¥ã®é‹å‹¢",
    desc: "éŠã³ç”¨ã®â€œäº€è£‚å ã„â€ã€‚æ°—ã«å…¥ã‚‰ãªã‘ã‚Œã°å¼•ãç›´ã—ã¦OKã€‚",
    hint: "ãƒœã‚¿ãƒ³ã§ä¸€å›å¼•ã„ã¦ã¿ã¦ã€‚",
    footer: "â€» ã‚ãã¾ã§éŠã³ã§ã™ã€‚",
    luckLabel: "ä»Šæ—¥ã®é‹(%)",
    roll: "ğŸ”® é‹å‹¢ã‚’å¼•ã"
  }
};

const fortunes = {
  ko: [
    {t:"ê· ì—´ì´ ë¯¸ì†Œ ì§“ëŠ” ë‚ ", d:"ì‘ì€ ì„ íƒì´ í° ê²°ê³¼ë¡œ íŠ„ë‹¤. ì˜¤ëŠ˜ì€ â€˜ë°”ë¡œ í•˜ê¸°â€™ê°€ ì´ê¸´ë‹¤.", luck: 82, e:"ğŸŒŒ"},
    {t:"ì ¤ë¦¬ ë©˜íƒˆ ê°•í™”", d:"ê°ì • ë‚­ë¹„ ì¤„ì´ë©´ ì²´ë ¥ ë‚¨ëŠ”ë‹¤. ë§ì€ ì§§ê²Œ, ê²°ì •ì€ ë¹ ë¥´ê²Œ.", luck: 68, e:"ğŸŸ£"},
    {t:"ë„¤ì½”ë§ˆíƒ€ì˜ ì´‰", d:"ëˆˆì¹˜ê°€ ë¯¸ì¹œë‹¤. ì´ìƒí•œ ë‚Œìƒˆ ëŠë¼ë©´ ê·¸ìª½ì´ ì •ë‹µ.", luck: 74, e:"ğŸ¾"},
    {t:"ë°˜ì§ ìš´ë¹¨", d:"ê°€ì± /ë½‘ê¸°/ëœë¤ì€ ì˜¤ëŠ˜ ìœ ë¦¬. ë‹¨, ê³¼ëª°ì… ê¸ˆì§€.", luck: 79, e:"âœ¨"},
    {t:"ì¡°ìš©í•œ íšŒë³µ", d:"ë¬´ë¦¬í•˜ë©´ ê¹¨ì§„ë‹¤. ì»¨ë””ì…˜ ê´€ë¦¬ê°€ ìµœìš°ì„ .", luck: 61, e:"ğŸ«§"},
    {t:"ëŒ€í™”ìš´", d:"í•œ ë§ˆë””ê°€ ì‚¬ëŒ ë¶™ì¸ë‹¤. ê³ ì • ë©˜íŠ¸ í•˜ë‚˜ ì¤€ë¹„í•´.", luck: 70, e:"ğŸ’¬"},
    {t:"ì§‘ì¤‘ ëª¨ë“œ", d:"í•œ ë²ˆ ë¶™ìœ¼ë©´ ê¸¸ê²Œ ê°„ë‹¤. ì •ë¦¬/ì‘ì—…/ê°œë°œì— ê°•í•¨.", luck: 76, e:"ğŸ§ "},
    {t:"ìŠ¤í¬íŠ¸ë¼ì´íŠ¸", d:"ì‚¬ëŒì´ ëª¨ì¸ë‹¤. ëŒ€ì‹  ë§ì‹¤ìˆ˜ë§Œ ì¡°ì‹¬.", luck: 73, e:"ğŸ™ï¸"}
  ],
  en: [
    {t:"The Rift Smiles", d:"Small choices snowball. â€˜Do it nowâ€™ wins today.", luck: 82, e:"ğŸŒŒ"},
    {t:"Gel Mind, Strong", d:"Save your energy. Short words, quick decisions.", luck: 68, e:"ğŸŸ£"},
    {t:"Nekomata Instinct", d:"Your gut is sharp. If something feels off, it is.", luck: 74, e:"ğŸ¾"},
    {t:"Spark Luck", d:"Random pulls favor you. Donâ€™t overdo it.", luck: 79, e:"âœ¨"},
    {t:"Quiet Recovery", d:"Donâ€™t push too hard. Protect your condition.", luck: 61, e:"ğŸ«§"},
    {t:"Talk Luck", d:"One line can hook people. Prepare a signature phrase.", luck: 70, e:"ğŸ’¬"},
    {t:"Focus Mode", d:"Deep work goes well. Organize, build, ship.", luck: 76, e:"ğŸ§ "},
    {t:"Spotlight", d:"Eyes on you today. Avoid careless slips.", luck: 73, e:"ğŸ™ï¸"}
  ],
  ja: [
    {t:"äº€è£‚ãŒå¾®ç¬‘ã‚€æ—¥", d:"å°ã•ãªé¸æŠãŒå¤§ããè·³ã­ã‚‹ã€‚ã€Œä»Šã‚„ã‚‹ã€ãŒå‹ã¤ã€‚", luck: 82, e:"ğŸŒŒ"},
    {t:"ã‚¸ã‚§ãƒ«ç²¾ç¥å¼·åŒ–", d:"æ„Ÿæƒ…ã®ç„¡é§„é£ã„ã‚’æ¸›ã‚‰ã™ã¨æ¥½ã€‚çŸ­ãè©±ã—ã¦ã€æ—©ãæ±ºã‚ã‚‹ã€‚", luck: 68, e:"ğŸŸ£"},
    {t:"ãƒã‚³ãƒã‚¿ã®å‹˜", d:"ç›´æ„ŸãŒå†´ãˆã‚‹ã€‚é•å’Œæ„ŸãŒã‚ã£ãŸã‚‰ãã£ã¡ãŒæ­£è§£ã€‚", luck: 74, e:"ğŸ¾"},
    {t:"ã‚­ãƒ©é‹", d:"ã‚¬ãƒãƒ£é‹ã‚ˆã—ã€‚ã‚„ã‚Šã™ãæ³¨æ„ã€‚", luck: 79, e:"âœ¨"},
    {t:"é™ã‹ãªå›å¾©", d:"ç„¡ç†ã™ã‚‹ã¨å´©ã‚Œã‚‹ã€‚ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³æœ€å„ªå…ˆã€‚", luck: 61, e:"ğŸ«§"},
    {t:"ä¼šè©±é‹", d:"ä¸€è¨€ã§äººãŒé›†ã¾ã‚‹ã€‚æ±ºã‚å°è©ã‚’ç”¨æ„ã™ã‚‹ã¨å¼·ã„ã€‚", luck: 70, e:"ğŸ’¬"},
    {t:"é›†ä¸­ãƒ¢ãƒ¼ãƒ‰", d:"ä½œæ¥­ãŒä¼¸ã³ã‚‹æ—¥ã€‚æ•´ç†ãƒ»åˆ¶ä½œãƒ»é–‹ç™ºãŒé€²ã‚€ã€‚", luck: 76, e:"ğŸ§ "},
    {t:"ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆ", d:"æ³¨ç›®ãŒé›†ã¾ã‚‹ã€‚ã†ã£ã‹ã‚Šç™ºè¨€ã ã‘æ³¨æ„ã€‚", luck: 73, e:"ğŸ™ï¸"}
  ]
};

/* BGM Tracks (local files) */
const tracks = [
  { label: "Manipulate", file: "Manipulate.mp3" },
  { label: "himituno_osyaberi", file: "himituno_osyaberi.mp3" },
  { label: "ã‚ˆãµã‹ã—ã¯00_59ã¾ã§", file: "ã‚ˆãµã‹ã—ã¯00_59ã¾ã§.wav" },
  { label: "ãƒã‚¢ãƒ•ãƒ«ãƒ‡ã‚¤ã‚º", file: "ãƒã‚¢ãƒ•ãƒ«ãƒ‡ã‚¤ã‚º.wav" },
  { label: "í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë¸Œê¸ˆ", file: "í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë¸Œê¸ˆ.wav" }
];

/* DOM */
const chips = document.querySelectorAll('.chip');
const tabs = document.querySelectorAll('.tab');
const clickSound = document.getElementById('clickSound');

const bgm = document.getElementById('bgm');
const bgmToggle = document.getElementById('bgm-toggle');
const themeToggle = document.getElementById('theme-toggle');
const trackSelect = document.getElementById('track-select');

const greetingEl = document.getElementById('greeting');

// Fortune DOM
const fortuneTitleEl = document.getElementById('fortune-title');
const fortuneDescEl = document.getElementById('fortune-desc');
const fortuneDateEl = document.getElementById('fortune-date');
const fortuneHintEl = document.getElementById('fortune-hint');
const fortuneRollBtn = document.getElementById('fortune-roll');
const fortuneResultEl = document.getElementById('fortune-result');
const fortuneFooterEl = document.getElementById('fortune-footer');
const luckLabelEl = document.getElementById('luck-label');
const luckFillEl = document.getElementById('luck-fill');

const sections = {
  home: document.getElementById('section-home'),
  rules: document.getElementById('section-rules'),
  schedule: document.getElementById('section-schedule'),
  fortune: document.getElementById('section-fortune'),
  rp: document.getElementById('section-rp')
};

let currentLang = 'ko';

/* Helpers */
function playClick(){
  clickSound.currentTime = 0;
  clickSound.play().catch(()=>{});
}

/* Tabs */
function setTab(tabName){
  tabs.forEach(t => t.classList.remove('active'));
  document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');

  Object.values(sections).forEach(s => s.classList.remove('active'));
  sections[tabName].classList.add('active');
}

tabs.forEach(t => {
  t.addEventListener('click', () => {
    playClick();
    setTab(t.dataset.tab);
  });
});

/* Render HOME */
function renderHome(lang){
  const h = homeData[lang];
  document.getElementById('home-title').textContent = h.title;
  document.getElementById('home-desc').textContent = h.desc;

  const greet = greetings[lang][Math.floor(Math.random()*greetings[lang].length)];
  greetingEl.textContent = greet;
}

/* Render RULES */
function renderRules(lang){
  const r = rulesData[lang];
  document.getElementById('rules-title').textContent = r.title;
  document.getElementById('rules-desc').textContent = r.desc;
  document.getElementById('rules-footer').textContent = r.footer;
  document.getElementById('rules').innerHTML = r.list.map(x => `<li>${x}</li>`).join('');
}

/* Render SCHEDULE */
function renderSchedule(lang){
  const s = scheduleData[lang];
  document.getElementById('schedule-title').textContent = s.title;
  document.getElementById('schedule-time').textContent = s.time;
  document.getElementById('schedule-note1').textContent = s.note1;
  document.getElementById('schedule-footer').textContent = s.footer;
  document.getElementById('schedule-list').innerHTML = s.days.map(d => `<li>${d}</li>`).join('');
}

/* Render FORTUNE */
function renderFortune(lang){
  const f = fortuneData[lang];
  fortuneTitleEl.textContent = f.title;
  fortuneDescEl.textContent = f.desc;
  fortuneHintEl.textContent = f.hint;
  fortuneFooterEl.textContent = f.footer;
  luckLabelEl.textContent = f.luckLabel;
  fortuneRollBtn.textContent = f.roll;

  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth()+1).padStart(2,'0');
  const dd = String(now.getDate()).padStart(2,'0');
  fortuneDateEl.textContent = `${yyyy}-${mm}-${dd}`;

  // Load saved fortune for today (per lang)
  const key = `avenia_fortune_${lang}_${yyyy}-${mm}-${dd}`;
  const saved = localStorage.getItem(key);
  if(saved){
    try{
      const obj = JSON.parse(saved);
      showFortune(obj);
    }catch{
      // ignore
    }
  } else {
    fortuneResultEl.textContent = "";
    luckFillEl.style.width = "0%";
  }
}

// seeded RNG (deterministic-ish)
function xmur3(str){
  let h = 1779033703 ^ str.length;
  for (let i = 0; i < str.length; i++) {
    h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
    h = (h << 13) | (h >>> 19);
  }
  return function() {
    h = Math.imul(h ^ (h >>> 16), 2246822507);
    h = Math.imul(h ^ (h >>> 13), 3266489909);
    h ^= h >>> 16;
    return h >>> 0;
  }
}
function mulberry32(a){
  return function(){
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  }
}

function pickFortune(lang){
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth()+1).padStart(2,'0');
  const dd = String(now.getDate()).padStart(2,'0');

  // Seed based on date + lang (so it feels daily)
  const seedFn = xmur3(`${lang}-${yyyy}-${mm}-${dd}-Avenia`);
  const rand = mulberry32(seedFn());
  const list = fortunes[lang];
  const idx = Math.floor(rand() * list.length);
  // add a bit of variance on luck
  const base = list[idx].luck;
  const jitter = Math.floor((rand()*12) - 6); // -6..+5
  const luck = Math.max(5, Math.min(95, base + jitter));

  return { ...list[idx], luck, date: `${yyyy}-${mm}-${dd}` };
}

function showFortune(obj){
  fortuneResultEl.textContent = `${obj.e}  ${obj.t}\n${obj.d}`;
  // animate bar
  requestAnimationFrame(() => {
    luckFillEl.style.width = `${obj.luck}%`;
    luckLabelEl.textContent = `${fortuneData[currentLang].luckLabel} : ${obj.luck}%`;
  });
}

/* Render RP */
function renderRP(lang){
  const r = rpData[lang];
  document.getElementById('rp-title').textContent = r.title;
  document.getElementById('rp-badge').textContent = r.badge;
  document.getElementById('rp-text').textContent = r.text;
  document.getElementById('rp-stream-setting').textContent = r.streamSetting;
  document.getElementById('label-slime').textContent = r.slimeLabel;
  document.getElementById('label-human').textContent = r.humanLabel;
}

/* Language Switch */
chips.forEach(chip => {
  chip.addEventListener('click', () => {
    playClick();
    chips.forEach(c => c.classList.remove('active'));
    chip.classList.add('active');

    currentLang = chip.dataset.lang;
    renderAll(currentLang);
  });
});

function renderAll(lang){
  renderHome(lang);
  renderRules(lang);
  renderSchedule(lang);
  renderFortune(lang);
  renderRP(lang);
}

/* Theme */
function applyTheme(theme){
  document.documentElement.setAttribute('data-theme', theme);
  localStorage.setItem('avenia_theme', theme);
  themeToggle.textContent = (theme === 'dark') ? "â˜€ï¸ Day" : "ğŸŒ™ Night";
}

themeToggle.addEventListener('click', () => {
  playClick();
  const cur = document.documentElement.getAttribute('data-theme') || 'light';
  applyTheme(cur === 'dark' ? 'light' : 'dark');
});

/* BGM */
bgm.volume = 0.28;

// Populate tracks
function populateTracks(){
  trackSelect.innerHTML = tracks.map(t => `<option value="${t.file}">${t.label}</option>`).join('');
}
function setTrack(file, autoplay=false){
  if(!file) return;
  bgm.src = file;
  localStorage.setItem('avenia_track', file);
  if(autoplay){
    bgm.play().then(()=>{
      bgmToggle.textContent = 'ğŸµ BGM Off';
    }).catch(()=>{
      // autoplay blocked
      bgmToggle.textContent = 'ğŸµ BGM On';
    });
  }
}

populateTracks();
trackSelect.addEventListener('change', () => {
  playClick();
  setTrack(trackSelect.value, true);
});

window.addEventListener('load', async () => {
  // Theme load
  const savedTheme = localStorage.getItem('avenia_theme');
  applyTheme(savedTheme || 'light');

  // Default renders
  renderAll(currentLang);

  // Init track
  const savedTrack = localStorage.getItem('avenia_track') || tracks[0].file;
  trackSelect.value = savedTrack;
  setTrack(savedTrack, false);

  // Fortune roll
  fortuneRollBtn.addEventListener('click', () => {
    playClick();
    const obj = pickFortune(currentLang);
    showFortune(obj);
    const key = `avenia_fortune_${currentLang}_${obj.date}`;
    localStorage.setItem(key, JSON.stringify(obj));
  });

  // Auto BGM
  try{
    await bgm.play();
    bgmToggle.textContent = 'ğŸµ BGM Off';
  }catch{
    bgmToggle.textContent = 'ğŸµ BGM On';
  }
});

bgmToggle.addEventListener('click', () => {
  playClick();
  if (bgm.paused){
    bgm.play().catch(()=>{});
    bgmToggle.textContent = 'ğŸµ BGM Off';
  } else {
    bgm.pause();
    bgmToggle.textContent = 'ğŸµ BGM On';
  }
});
</script>

</body>
</html>
